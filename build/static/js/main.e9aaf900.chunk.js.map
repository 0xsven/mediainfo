{"version":3,"sources":["index.js"],"names":["registerPlugin","FilePondPluginImageExifOrientation","FilePondPluginImagePreview","CHUNK_SIZE","rootElement","document","getElementById","ReactDOM","render","react__WEBPACK_IMPORTED_MODULE_1___default","a","createElement","_useState","useState","_useState2","Object","_Users_0xsven_dev_Lab_mediainfo_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__","files","setFiles","_useState3","_useState4","data","setData","miLib","useRef","mi","x2js","processing","parseFile","file","current","fileSize","size","offset","state","seek","open_buffer_init","processChunk","e","l","target","error","msg","console","err","processingDone","alert","chunk","Uint8Array","result","length","open_buffer_continue","seekTo","seekToLow","open_buffer_continue_goto_get_lower","seekToHigh","open_buffer_continue_goto_get_upper","inform","close","name","resultObj","xml_str2json","date","Date","fileName","addResult","r","FileReader","blob","slice","onload","readAsArrayBuffer","useEffect","window","MediaInfo","X2JS","className","react_filepond__WEBPACK_IMPORTED_MODULE_3__","allowMultiple","onupdatefiles","labelIdle","File","track","map","keys","key"],"mappings":"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","file":"static/js/main.e9aaf900.chunk.js","sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport ReactDOM from 'react-dom';\n// Import React FilePond\nimport { FilePond, registerPlugin } from 'react-filepond';\n\n// Import FilePond styles\nimport 'filepond/dist/filepond.min.css';\nimport './styles.css';\n\n// Import the Image EXIF Orientation and Image Preview plugins\n// Note: These need to be installed separately\n// `npm i filepond-plugin-image-preview filepond-plugin-image-exif-orientation --save`\nimport FilePondPluginImageExifOrientation from 'filepond-plugin-image-exif-orientation';\nimport FilePondPluginImagePreview from 'filepond-plugin-image-preview';\nimport 'filepond-plugin-image-preview/dist/filepond-plugin-image-preview.css';\n\n// Register the plugins\nregisterPlugin(FilePondPluginImageExifOrientation, FilePondPluginImagePreview);\n\nconst CHUNK_SIZE = 5 * 1024 * 1024;\n\nfunction App() {\n  const [files, setFiles] = useState([]);\n  const [data, setData] = useState(null);\n  const miLib = useRef(null);\n  const mi = useRef(null);\n  const x2js = useRef(null);\n  const processing = useRef(false);\n\n  useEffect(() => {\n    miLib.current = window.MediaInfo(function() {\n      mi.current = new miLib.current.MediaInfo();\n    });\n    x2js.current = new window.X2JS();\n  }, []);\n\n  function addResult(name, result) {\n    const resultObj = x2js.current.xml_str2json(result);\n    resultObj.date = new Date();\n    resultObj.fileName = name;\n    setData(resultObj);\n  }\n\n  function parseFile(file) {\n    if (processing.current) {\n      return;\n    }\n    processing.current = true;\n\n    var fileSize = file.size,\n      offset = 0,\n      state = 0,\n      // seekTo = -1,\n      seek = null;\n\n    mi.current.open_buffer_init(fileSize, offset);\n\n    var processChunk = function(e) {\n      var l;\n      if (e.target.error === null) {\n        var chunk = new Uint8Array(e.target.result);\n        l = chunk.length;\n        state = mi.current.open_buffer_continue(chunk, l);\n\n        var seekTo = -1;\n        var seekToLow = mi.current.open_buffer_continue_goto_get_lower();\n        var seekToHigh = mi.current.open_buffer_continue_goto_get_upper();\n\n        if (seekToLow === -1 && seekToHigh === -1) {\n          seekTo = -1;\n        } else if (seekToLow < 0) {\n          seekTo = seekToLow + 4294967296 + seekToHigh * 4294967296;\n        } else {\n          seekTo = seekToLow + seekToHigh * 4294967296;\n        }\n\n        if (seekTo === -1) {\n          offset += l;\n        } else {\n          offset = seekTo;\n          mi.current.open_buffer_init(fileSize, seekTo);\n        }\n        chunk = null;\n      } else {\n        var msg = 'An error happened reading your file!';\n        console.err(msg, e.target.error);\n        processingDone();\n        alert(msg);\n        return;\n      }\n      // bit 4 set means finalized\n      if (state & 0x08) {\n        var result = mi.current.inform();\n        mi.current.close();\n        addResult(file.name, result);\n        processingDone();\n        return;\n      }\n      seek(l);\n    };\n\n    function processingDone() {\n      processing.current = false;\n    }\n\n    seek = function(length) {\n      if (processing.current) {\n        var r = new FileReader();\n        var blob = file.slice(offset, length + offset);\n        r.onload = processChunk;\n        r.readAsArrayBuffer(blob);\n      } else {\n        mi.current.close();\n        processingDone();\n      }\n    };\n\n    // start\n    seek(CHUNK_SIZE);\n  }\n\n  useEffect(() => {\n    if (files.length > 0) parseFile(files[0].file);\n    else setData(null);\n  }, [files]);\n\n  return (\n    <div className=\"App\">\n      <FilePond\n        files={files}\n        allowMultiple={false}\n        onupdatefiles={setFiles}\n        labelIdle='Drag & Drop your files or <span class=\"filepond--label-action\">Browse</span>'\n      />\n      {data && (\n        <div className=\"data\">\n          {data.File.track.map(track => (\n            <div className=\"track\">\n              <div className=\"title\">{track['_type']} Track</div>\n              {Object.keys(track).map(key => (\n                <div key={key} className=\"row\">\n                  <label>{key}</label> {track[key]}\n                </div>\n              ))}\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n\nconst rootElement = document.getElementById('root');\nReactDOM.render(<App />, rootElement);\n"],"sourceRoot":""}